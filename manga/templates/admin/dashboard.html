{% extends "admin/base_admin.html" %}
{% block title %}Dashboard{% endblock %}
{% block admin_content %}
<h1 class="admin-page-title">Dashboard</h1>

<div class="stat-grid">
  <div class="stat-box"><i class="fas fa-book"></i><div><span class="stat-num">{{ total_manga }}</span><span class="stat-label">Manga</span></div></div>
  <div class="stat-box"><i class="fas fa-layer-group"></i><div><span class="stat-num">{{ total_chapters }}</span><span class="stat-label">Chapters</span></div></div>
  <div class="stat-box"><i class="fas fa-users"></i><div><span class="stat-num">{{ total_users }}</span><span class="stat-label">Users</span></div></div>
  <div class="stat-box"><i class="fas fa-bookmark"></i><div><span class="stat-num">{{ total_bookmarks }}</span><span class="stat-label">Bookmarks</span></div></div>
  <div class="stat-box"><i class="fas fa-comments"></i><div><span class="stat-num">{{ total_comments }}</span><span class="stat-label">Comments</span></div></div>
  <div class="stat-box"><i class="fas fa-tags"></i><div><span class="stat-num">{{ total_genres }}</span><span class="stat-label">Genres</span></div></div>
</div>

<div class="admin-grid-2">
  <!-- Recent Manga -->
  <div class="admin-card">
    <h3>Recent Manga <a href="{% url 'admin_manga_list' %}" class="see-all">View All</a></h3>
    <table class="admin-table">
      <thead><tr><th>Title</th><th>Type</th><th>Status</th></tr></thead>
      <tbody>
        {% for m in recent_manga %}
        <tr>
          <td><a href="{% url 'admin_manga_edit' m.id %}">{{ m.title|truncatechars:40 }}</a></td>
          <td>{{ m.manga_type }}</td>
          <td><span class="badge badge-sm">{{ m.status }}</span></td>
        </tr>
        {% empty %}<tr><td colspan="3" class="text-muted">No manga yet</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Recent Users -->
  <div class="admin-card">
    <h3>Recent Users <a href="{% url 'admin_users' %}" class="see-all">View All</a></h3>
    <table class="admin-table">
      <thead><tr><th>Username</th><th>Email</th><th>Joined</th></tr></thead>
      <tbody>
        {% for u in recent_users %}
        <tr>
          <td>{{ u.username }}</td>
          <td>{{ u.email|truncatechars:25 }}</td>
          <td>{{ u.created_at|timesince }} ago</td>
        </tr>
        {% empty %}<tr><td colspan="3" class="text-muted">No users yet</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- Recent Chapters -->
<div class="admin-card">
  <h3>Recent Chapters</h3>
  <table class="admin-table">
    <thead><tr><th>Manga</th><th>Chapter</th><th>Added</th></tr></thead>
    <tbody>
      {% for ch in recent_chapters %}
      <tr>
        <td>{{ ch.manga.title|truncatechars:40 }}</td>
        <td>Ch. {{ ch.number }}{% if ch.title %} â€” {{ ch.title }}{% endif %}</td>
        <td>{{ ch.created_at|timesince }} ago</td>
      </tr>
      {% empty %}<tr><td colspan="3" class="text-muted">No chapters yet</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
